
### spark 에서 연봉 순대로 보여주기


from pyspark.sql import SparkSession
from pyspark.sql.functions import split,explode,col

if __name__=="__main__":
        spark = SparkSession.builder.appName("OrderBySal").getOrCreate()
        df1=spark.read.load("hdfs:///user/maria_dev/result_5200.csv",format="csv", sep=",",inferSchema="true",header="true")

        df1.createOrReplaceTempView("sample")
        #df2.select(df2.movieId, df2.title,explode(split(df2.genres, #'\|'))).createOrReplaceTempView("movies")

        result = spark.sql("""
                SELECT name,title,avg_salary
                FROM sample
                ORDER BY avg_salary DESC LIMIT 30
                """)
        for row in result.collect():
                print(row.name , row.title, row.avg_salary)

## Hive 에서 연봉 순대로 보여주기 


